# プロジェクトルール

## 概要

このドキュメントは、プロジェクト全体で統一された運用を実現するためのルールを定めたものです。
人間だけでなく、AIが読むことも前提とします。

## 全体方針

- AI Agentにプロジェクト推進を依頼した場合、極力スムーズに進行できるようにする
- AIが作成したコードやドキュメントを、人間が使いやすく、理解しやすい形にする

## Markdown記法ルール

プロジェクト内のMarkdownファイルでは、読み手に応じて記法を使い分けます。  
この使い分けにより、人間には読みやすく、AIには処理しやすいドキュメント構成を実現します。

### README.mdの記法
- **考え方**: 人間の読みやすさを重視
- **見出し記法**: 
  - レベル1: `===`（80個、ファイルの頭に1回だけ使用）
  - レベル2: `---`（80個）
  - レベル3以降: `###`や `####`等を使用
- **構成**: 表と箇条書きを使い分ける
  - 表を使用: コマンドとその説明、設定項目とその値
  - 箇条書きを使用: 上記以外の全て（説明・ポイント系）
  - 判断基準: 「何かを実行する系」は表、「説明・ポイント系」は箇条書き

### その他の.mdファイルの記法
- **考え方**: AIの処理しやすさを重視
- **見出し**: `#`記法を使用（`#`, `##`, `###`等）
- **構成**: 箇条書きやシンプルな構造を使用


## ディレクトリ構造ルール

プロジェクトのディレクトリ構造を標準化するためのルールを記載します。

### 基本ルール

* プロジェクトのルートディレクトリには必ず `README.md` を配置すること。
* プロジェクトに必要なセットアップやビルド手順を明確に記述した `Makefile` を必ず配置すること。

### ディレクトリ構造例

以下にディレクトリ構造のサンプルを示します。  
project-rootのファイルは最小限に保ちます。

```
project-root/
├── README.md             # プロジェクトの概要、使い方、セットアップ方法など
├── Makefile              # ビルドやテスト、実行用コマンドを定義
├── .gitignore            # バージョン管理から除外するファイルを定義
├── bin/                  # 実行可能なスクリプトやバイナリを配置するディレクトリ
├── src/                  # ソースコードを配置するディレクトリ
├── container/            # Dockerfileなどコンテナ関連ファイルを配置するディレクトリ
├── docs/                 # ドキュメントを配置するディレクトリ
├── tests/                # テストコードを配置するディレクトリ
├── config/               # 設定ファイルを配置するディレクトリ
├── scripts/              # 補助スクリプト（ビルド、デプロイ等）を配置するディレクトリ
├── logs/                 # アプリケーションのログファイルを配置するディレクトリ
└── tmp/                  # 一時的なファイルを配置（バージョン管理対象外）するディレクトリ
```

### バージョン管理から除外するファイル

Gitのバージョン管理が不要なファイルは.gitignoreに定義して除外します。各プロジェクトで実際に生成されるファイルに合わせて随時追加・調整する方針とします。

- 一時ファイル: 開発中に生成される一時的なファイルは除外。
- ログファイル: アプリケーションが生成するログファイルも除外。
- OSやエディタ固有のファイル: 開発環境固有のファイルを除外。
- ビルド結果: ビルドやコンパイルによって生成されるファイルも除外。


## Makefileルール

- Makefileは、必要なセットアップやビルドが行えるように記載する。
- 各ターゲットのレシピ部分は3行以内に収め、シンプルに保つ。(複雑な処理が必要な場合はscriptsに.shなどを配置し、Makefileから呼ぶようにする)
- 各コマンドには`##`でコメントを記載する。
- 下記のようにhelpを設け、`##`で記載したコメントを一覧表示できるようにする。

```
help: ## このヘルプを表示
	@grep -E '^[a-zA-Z0-9_.-]+:.*## ' $(MAKEFILE_LIST) \
	| awk 'BEGIN {FS=":.*## "}; {printf "  \033[36m%-20s\033[0m %s\n", $$1, $$2}'
```

## 図の作成ルール

コードやドキュメントを解しやすい形にするために、必要に応じて図の作成を行う。  

- 作成方法は、AIが理解しやすいPlantUMLを採用する。(.pumlを作成後、.svgに変換する)
- `docs/diagrams/` ディレクトリに配置する。(変換前後両方)
- `![システム構成図](docs/diagrams/system-overview.svg)`のような形でドキュメントから参照する。

### ファイル命名規則

- 形式: `{目的}-{種類}.{拡張子}` (例: `system-overview.puml`, `db-erd.puml`)
- 拡張子以外は返還前後で同じにする(例: `system-overview.puml`, `system-overview.svg`)
- テンプレート: `template-{種類}.puml` （例: `template-system.puml`）

### 図の生成方法

```bash
# 特定のファイルをSVG変換
plantuml docs/diagrams/target.puml

# 全.pumlファイルを一括変換
plantuml "docs/diagrams/*.puml"
```

- `.puml`ファイルと同じ場所に`.svg`ファイルが生成される
- **必須**: SVG出力後は内容を確認し、エラーになっていないかチェックする

